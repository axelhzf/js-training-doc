<!DOCTYPE html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width">
  <title>Angular.js | js-training</title>
  <link rel="stylesheet" href="/styles/main.css">
</head>
<body>
  <header>
    <div class="logo">JS<small>training</small></div>
  </header>
  <div class="content"><h1 id="angular-js">Angular.js</h1>
<h2 id="qu-es-angular">Qué es angular</h2>
<p>En la web de angular se definen asi.</p>
<blockquote>
<p>AngularJS is a structural framework for dynamic web apps. It lets you use HTML as your template language and lets you extend HTML&#39;s syntax to express your application&#39;s components clearly and succinctly. Angular&#39;s data binding and dependency injection eliminate much of the code you currently have to write. And it all happens within the browser, making it an ideal partner with any server technology.</p>
</blockquote>
<h2 id="caracter-sticas">Características</h2>
<ul>
<li>Data binding, as in {{}}</li>
<li>DOM control structures for repeating/hiding DOM fragments.</li>
<li>Support for forms and form validation.</li>
<li>Attaching code-behind to DOM elements.</li>
<li>Grouping of HTML into reusable components.</li>
</ul>
<h2 id="getting-started">Getting started</h2>
<p>Una de las principales ventajas de Angular es que es un sencillo empezar. Como por ejemplo con uno de los ejemplos que aparece en la web de angular</p>
<pre><code class="lang-html"><span class="hljs-doctype">&lt;!doctype html&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">html</span> <span class="hljs-attribute">ng-app</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">src</span>=<span class="hljs-value">"https://ajax.googleapis.com/ajax/libs/angularjs/1.3.0-beta.3/angular.min.js"</span>&gt;</span><span class="javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">label</span>&gt;</span>Name:<span class="hljs-tag">&lt;/<span class="hljs-title">label</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text"</span> <span class="hljs-attribute">ng-model</span>=<span class="hljs-value">"yourName"</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">"Enter a name here"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">hr</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Hello {{yourName}}!<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">html</span>&gt;</span>
</code></pre>
<p>En este ejemplo parece que no hay nada de JavaScript, únicamente tags html. Si nos fijamos en detalle, vemos algunos atributos que no pertenecen al standard html como <code>ng-app</code> que define el elemento raiz de la aplicación. También tenemos un ejemplo de databinding utilizando <code>ng-model</code> que permite hacer un binding bidireccional entre el input y una property definida en el scope. Esa misma property es la que estamos mostrando con la interpolación de variables <code>{{}}</code>. El binding funciona directamente sin que tengamos que escribir nada de código JavaScript</p>
<h1 id="bindings">Bindings</h1>
<p>Data-binding es el mecanismo de sincronización automática de datos entre los modelos y las vistas. Angular lo implementa de forma automática, así que a diferencia de Backbone no nos tendremos que preocupar de buscar el momento adecuado para renderizar las vistas. El binding en angular es bidireccional. Cualquier cambio en la vista se refleja inmediatamente en el modelo y cualquier cambio en el modelo se refleja inmediatamente en la vista.</p>
<p><img src="images/ng-binding-one.png" alt="One way binding"></p>
<p><img src="images/ng-binding-one.png" alt="Two way binding"></p>
<pre><code class="lang-html"><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">ng-app</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"number"</span> <span class="hljs-attribute">ng-model</span>=<span class="hljs-value">"a"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"number"</span> <span class="hljs-attribute">ng-model</span>=<span class="hljs-value">"b"</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span></span><span class="hljs-expression">{{<span class="hljs-variable">a</span> + <span class="hljs-variable">b</span>}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span></span>
</code></pre>
<p><a href="http://jsbin.com/jaxuteto/1/">http://jsbin.com/jaxuteto/1/</a></p>
<h1 id="controllers">Controllers</h1>
<p>Los controladores en angular son constructores que se utilizan para aumentar el scope. Cuando un controlador se asocia al DOM a través de la directiva <code>ng-controller</code> Angular va a instanciar un nueva instancia de ese controlador. El scope estará disponible dentro de la función en el parámetro <code>$scope</code>.</p>
<p>Los controladores se utilizan para establecer el estado inicial del $scope y para añadir comportamiento.</p>
<pre><code class="lang-html"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">ng-app</span>=<span class="hljs-value">"myapp"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">ng-controller</span>=<span class="hljs-value">"HelloController"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span>&gt;</span></span><span class="hljs-expression">{{<span class="hljs-variable">message</span>}}</span><span class="xml"> </span><span class="hljs-expression">{{<span class="hljs-variable">counter</span>}}</span><span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">button</span> <span class="hljs-attribute">ng-click</span>=<span class="hljs-value">"increment()"</span>&gt;</span>Increment<span class="hljs-tag">&lt;/<span class="hljs-title">button</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span></span>
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> app = angular.module(<span class="hljs-string">"myapp"</span>, []);

app.controller(<span class="hljs-string">"HelloController"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$scope</span>)</span> {</span>
  <span class="hljs-variable">$scope</span>.message= <span class="hljs-string">"Hola"</span>;
  <span class="hljs-variable">$scope</span>.counter = <span class="hljs-number">0</span>;

  <span class="hljs-variable">$scope</span>.increment = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
    <span class="hljs-variable">$scope</span>.counter++;
  }
})
</code></pre>
<p><a href="http://jsbin.com/fihageki/2/edit">http://jsbin.com/fihageki/2/edit</a></p>
<p>En los controladores no tenemos acceso a modificar el DOM, únicamente trabajaremos con los datos que hay en el scope. Lo recomendable es mantener el código de nuestos controladores lo más pequeño posible y extraer toda la lógica que sea posible a servicios para poder reutilizarla en varias vistas.</p>
<h1 id="compartir-datos-entre-controladores">Compartir datos entre controladores</h1>
<p>Para compartir datos entre distintos controladores vamos a utilizar servicios. Los servicios no son más que una forma de poder definir singletons dentro del contexto de nuestra aplicación. De forma que podamos utilizarlo dentro de los controladores utilizando inyección de dependencias.</p>
<pre><code class="lang-html"><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">ng-app</span>=<span class="hljs-value">"app"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">ng-controller</span>=<span class="hljs-value">"Controller1"</span>&gt;</span>
      </span><span class="hljs-expression">{{<span class="hljs-variable">dataService.message</span>}}</span><span class="xml">
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">ng-controller</span>=<span class="hljs-value">"Controller2"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text"</span> <span class="hljs-attribute">ng-model</span>=<span class="hljs-value">"dataService.message"</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span></span>
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> app = angular.module(<span class="hljs-string">"app"</span>, []);

app.factory(<span class="hljs-string">"dataService"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>

  <span class="hljs-keyword">var</span> dataService = {
    message : <span class="hljs-string">"hello world"</span>
  };

  <span class="hljs-keyword">return</span> dataService;
});


app.controller(<span class="hljs-string">"Controller1"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$scope</span>, dataService)</span> {</span>
  <span class="hljs-variable">$scope</span>.dataService = dataService;
});

app.controller(<span class="hljs-string">"Controller2"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$scope</span>, dataService)</span> {</span>
  <span class="hljs-variable">$scope</span>.dataService = dataService;  
});
</code></pre>
<p><a href="http://jsbin.com/bobipami/1/edit">http://jsbin.com/bobipami/1/edit</a></p>
<p>En la <a href="http://docs.angularjs.org/guide/providers">documentación de angular</a> hay más información acerca de los distintos tipos de providers.</p>
<h1 id="filters">Filters</h1>
<p>Los filtros se utilizan para darle formato a un valor a la hora de mostrarselo a el usuario. Se pueden utilizar en plantillas controladores o servicios.</p>
<pre><code class="lang-html"><span class="xml">  <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">ng-app</span>=<span class="hljs-value">"app"</span> <span class="hljs-attribute">ng-controller</span>=<span class="hljs-value">"MainController"</span>&gt;</span>
    </span><span class="hljs-expression">{{<span class="hljs-variable">message</span> | <span class="hljs-variable">reverse</span>}}</span><span class="xml">
    <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text"</span> <span class="hljs-attribute">ng-model</span>=<span class="hljs-value">"message"</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span></span>
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> app = angular.module(<span class="hljs-string">"app"</span>, []);

app.filter(<span class="hljs-string">"reverse"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(text)</span> {</span>
    <span class="hljs-keyword">return</span> text.split(<span class="hljs-string">""</span>).reverse().join(<span class="hljs-string">""</span>);
  };
});

app.controller(<span class="hljs-string">"MainController"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$scope</span>)</span> {</span>
  <span class="hljs-variable">$scope</span>.message = <span class="hljs-string">"Hola"</span>;
});
</code></pre>
<p><a href="http://jsbin.com/baxicaki/1/edit">http://jsbin.com/baxicaki/1/edit</a></p>
<p>Angular viene con algunos <a href="http://docs.angularjs.org/api/ng/filter">filtros ya definidos</a>.</p>
<h1 id="directives">Directives</h1>
<p>Las directivas son una de las partes más importantes de angular y es lo que nos va a permitir crear componentes reutilizables que podremos reutilizar a lo largo de la aplicación. Entender las directivas es algo clave para poder sacarle todo el potencial a angular. Las directivas son marcas en elementos del DOM (atributos, elementos o classes CSS) que le indican al compilador de html de angular que tiene añadir comportamiento en ese elemento o incluso que debe transformar ese elemento y sus hijos en otro.</p>
<p>Existen varias formas de utilizar directivas desde las plantillas html.</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">my-dir</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">my-dir</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">my-dir</span>=<span class="hljs-value">"exp"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
<span class="hljs-comment">&lt;!-- directive: my-dir exp --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">class</span>=<span class="hljs-value">"my-dir: exp;"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
</code></pre>
<p>Se recomienda utilizar las dos primeras formas.</p>
<p>Hay casos en los que el proceso de compilación de las directivas todavía no ha hecho su trabajo pero el html ya se ha renderizado.</p>
<pre><code class="lang-html"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">"img/</span></span></span><span class="hljs-expression">{{<span class="hljs-variable">username</span>}}</span><span class="xml"><span class="hljs-tag"><span class="hljs-value">.jpg"</span>&gt;</span>Hello </span><span class="hljs-expression">{{<span class="hljs-variable">username</span>}}</span><span class="xml">!<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span></span>
</code></pre>
<p>Para evitar que el usuario pueda hacer click en un enlace incorrecto es preferible utilizar la directiva <code>ng-href</code> de esta forma, únicamente cuando se haya compilado, estará disponible el enlace.</p>
<pre><code class="lang-html"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">ng-href</span>=<span class="hljs-value">"img/</span></span></span><span class="hljs-expression">{{<span class="hljs-variable">username</span>}}</span><span class="xml"><span class="hljs-tag"><span class="hljs-value">.jpg"</span>&gt;</span>Hello </span><span class="hljs-expression">{{<span class="hljs-variable">username</span>}}</span><span class="xml">!<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span></span>
</code></pre>
<p>El procesador de SVG es más estricto que el de HTML y lanza errores cuando encuentra valores que no considera correctos.</p>
<pre><code class="lang-html"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">svg</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">circle</span> <span class="hljs-attribute">cx</span>=<span class="hljs-value">"</span></span></span><span class="hljs-expression">{{<span class="hljs-variable">cx</span>}}</span><span class="xml"><span class="hljs-tag"><span class="hljs-value">"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">circle</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">svg</span>&gt;</span></span>
</code></pre>
<p>Es un problema similar al anterior. En este caso podemos utilizar la directiva más genérica <code>ng-attr</code> que permite definir el valor a cualquier atributo.</p>
<pre><code class="lang-html"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">svg</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">circle</span> <span class="hljs-attribute">ng-attr-cx</span>=<span class="hljs-value">"</span></span></span><span class="hljs-expression">{{<span class="hljs-variable">cx</span>}}</span><span class="xml"><span class="hljs-tag"><span class="hljs-value">"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">circle</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">svg</span>&gt;</span></span>
</code></pre>
<p>Las directivas se definen de una manera similar a los controladores. Para registrar una directiva se utiliza <code>module.directive</code> y definiendo una factory function. Esta función se va a invocar la primera vez que se encuentra un uso de la directiva. A la hora de nombrar las directicas es recomendable utilizar algúnt tipo de prefijo, por ejemplo, si estamos definiendo una directiva para representar un carousel deberíamos llamarla algo tipo <code>btfCarousel</code> en lugar de <code>carousel</code>.</p>
<p>Las directivas definen plantillas que pueden ser tanto inline (<code>template</code>, como ficheros externos (<code>templateUrl</code>).</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">ng-app</span>=<span class="hljs-value">"app"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">hello-world</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">hello-world</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> app = angular.module(<span class="hljs-string">"app"</span>, []);

app.directive(<span class="hljs-string">"helloWorld"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
  <span class="hljs-keyword">return</span> {
    restrict : <span class="hljs-string">"E"</span>,
    template : <span class="hljs-string">"&lt;h1&gt;Hola Mundo&lt;/h1&gt;"</span>
  };
});
</code></pre>
<p><a href="http://jsbin.com/qiwon/1/edit">http://jsbin.com/qiwon/1/edit</a></p>
<p>En este ejemplo estamos definiendo la directiva <code>helloWorld</code>. En la definición de la directiva, el campo <code>restrict</code> nos indica cómo vamos a poder utilizar la directiva, en este caso <code>E</code> que hace referencia a que vamos a poder utilizara la directiva como un elemento. Los valores posibles son:</p>
<ul>
<li><code>A</code> - Attribute name (Default)</li>
<li><code>E</code> - Elements</li>
<li><code>C</code> - Class name</li>
<li><code>M</code> - Comentarios</li>
</ul>
<p>Los valores se pueden combinar de forma que podríamos utilizar un valor tipo <code>AEC</code>. ¿Cuando deberíamos utilizar cada uno de los valores? En el caso de que estemos creando componentes nuevos, deberíamos utilizar <code>E</code>. En el caso de que estemos decorando de alguna forma elementos que ya existen, deberíamos utilizar <code>A</code>.</p>
<p>Por defectos las directivas tienen acceso a las variables definidas en el scope donde están contenidas.</p>
<pre><code class="lang-html">  <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">ng-app</span>=<span class="hljs-value">"app"</span> <span class="hljs-attribute">ng-controller</span>=<span class="hljs-value">"MainController"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">hello-world</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">hello-world</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> app = angular.module(<span class="hljs-string">"app"</span>, []);

app.controller(<span class="hljs-string">"MainController"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$scope</span>)</span> {</span>
  <span class="hljs-variable">$scope</span>.name = <span class="hljs-string">"Axel"</span>;
});


app.directive(<span class="hljs-string">"helloWorld"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
  <span class="hljs-keyword">return</span> {
    restrict : <span class="hljs-string">"E"</span>,
    template : <span class="hljs-string">"&lt;h1&gt;Hola {{name}}&lt;/h1&gt;"</span>
  };
});
</code></pre>
<p><a href="http://jsbin.com/leted/1/edit">http://jsbin.com/leted/1/edit</a></p>
<p>Depender de variables ya definidas en el scope puede llevar a errores. Además el nombre de la variable debe coincidir exactamente en todos los scopes donde vamos a utilizar la directiva. Es algo que no parece muy buena idea. Las directivas pueden definir su propio <strong>isolate scope</strong>.</p>
<pre><code class="lang-html"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">ng-app</span>=<span class="hljs-value">"app"</span> <span class="hljs-attribute">ng-controller</span>=<span class="hljs-value">"MainController"</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">hello-world</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">"user.name"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">hello-world</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> app = angular.module(<span class="hljs-string">"app"</span>, []);

app.controller(<span class="hljs-string">"MainController"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$scope</span>)</span> {</span>
  <span class="hljs-variable">$scope</span>.user = {
    name : <span class="hljs-string">"Axel"</span>
  };
});


app.directive(<span class="hljs-string">"helloWorld"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
  <span class="hljs-keyword">return</span> {
    restrict : <span class="hljs-string">"E"</span>,
    scope : {
      name : <span class="hljs-string">"="</span>
    },
    template : <span class="hljs-string">"&lt;h1&gt;Hola {{name}}&lt;/h1&gt;"</span>
  };
});
</code></pre>
<p><a href="http://jsbin.com/leted/2/edit">http://jsbin.com/leted/2/edit</a></p>
<p>En el objeto scope de define una property por cada uno de los atributos en los que la directiva a a poder hacer binding. Si queremos que el nombre sea distinto al utilizar la directiva que internamente, podemos utilizar</p>
<pre><code class="lang-js"><span class="hljs-tag">scope</span> : <span class="hljs-rules">{
  <span class="hljs-rule"><span class="hljs-attribute">customerInfo</span>:<span class="hljs-value"> <span class="hljs-string">"=info"</span>
</span></span></span>}
</code></pre>
<p>En este caso el valor del atributo será info, pero internamente, el valor de la variable dentro del scope será customerInfo. Existen varias estrategias a la hora de hacer el binding entre las variables definidas en el scope:</p>
<ul>
<li><strong>@</strong> - Se copia el valor del atributo como un string</li>
<li><strong>=</strong> - Binding bidireccional</li>
<li><strong>&amp;</strong> - Pasar una función del scope padre para que se llame mas adelante</li>
</ul>
<p>Las directivas son los únicos componentes que tienen acceso al DOM. Para ello se utiliza la función <code>link</code>.</p>
<pre><code class="lang-html">  <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">ng-app</span>=<span class="hljs-value">"app"</span>&gt;</span>    
      <span class="hljs-tag">&lt;<span class="hljs-title">h1</span> <span class="hljs-attribute">rotate</span>&gt;</span>Mensaje<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> app = angular.module(<span class="hljs-string">"app"</span>, []);


app.directive(<span class="hljs-string">"rotate"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
  <span class="hljs-keyword">return</span> {
    restrict: <span class="hljs-string">"A"</span>,
    link: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(scope, element, attrs)</span> {</span>
      $({deg: <span class="hljs-number">0</span>}).animate({deg: <span class="hljs-number">200</span>}, {
          duration: <span class="hljs-number">2000</span>,
          step: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(now)</span> {</span>
            element.css({
              transform: <span class="hljs-string">'rotate('</span> + now + <span class="hljs-string">'deg)'</span>
            });
          }
      }
      );
    }
  };
});
</code></pre>
<p><a href="http://jsbin.com/vivew/1/edit">http://jsbin.com/vivew/1/edit</a></p>
<p>En este ejemplo estamos probando la directiva rotate que permite rotar un elemento. Para poder acceder al elemento del DOM sobre el que vamos a aplicar la animación utilizamos el segundo parámetro de la función link. A diferencia de Backbone, Angular no tiene como dependencia jQuery. Tiene una implementación propia con la funcionalidades básicas de jQuery que se llama jqLite. El parámetro elemento es un objeto de tipo jqLite. Angular también es capaz de funcionar con jQuery, de forma que si encuentra que jQuery está cargado, el objeto element sera un objeto jQuery. </p>
<p>En el caso de que nuestras directivas necesiten algo de código cuando el elemento del DOM se elimina, por ejemplo si necesitamos desvincular algunos eventos o necesitamos eliminar algunos timmers, debemos escuchar el evento <code>$destroy</code>.</p>
<pre><code>element.on(<span class="hljs-string">'$destroy'</span>, <span class="hljs-keyword">...</span>)
</code></pre><p>Las directivas pueden envolver a otros elementos utilizando la opción <code>transclude</code>. Dentro de la plantilla de la directiva, se utiliza <code>ng-transclude</code> para incluir el contenido que está envuelto por el tag.</p>
<pre><code class="lang-html">&lt;h1&gt;Hello world&lt;/h1&gt;
&lt;modal&gt;
  Hello <span class="hljs-keyword">from</span> modal
&lt;/modal&gt;


&lt;<span class="hljs-keyword">script</span> type=<span class="hljs-string">"text/ng-template"</span> <span class="hljs-property">id</span>=<span class="hljs-string">"modal.html"</span>&gt;
  &lt;<span class="hljs-keyword">div</span> <span class="hljs-type">class</span>=<span class="hljs-string">"modal"</span> &gt;
    &lt;<span class="hljs-keyword">div</span> ng-transclude&gt;&lt;/<span class="hljs-keyword">div</span>&gt;
    &lt;button ng-click=<span class="hljs-string">"close()"</span>&gt;Close&lt;/button&gt;
  &lt;/<span class="hljs-keyword">div</span>&gt;
&lt;/<span class="hljs-keyword">script</span>&gt;
</code></pre>
<pre><code class="lang-js">app.directive(<span class="hljs-string">"modal"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
  <span class="hljs-keyword">return</span> {
    restrict: <span class="hljs-string">"E"</span>,
    templateUrl : <span class="hljs-string">"modal.html"</span>,
    transclude : <span class="hljs-literal">true</span>,
    link: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(scope, element, attrs)</span> {</span>
      scope.close = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
        element.hide();
      };
    }
  };
});
</code></pre>
<p>El contenido dentro de la directiva (sobre lo que hace transclude) tiene el scope del padre. Por tanto dentro del modal podríamos acceder a variables definidas en el controlador, pero no a variables definidas dentro de la directiva.</p>
<p>Hay situaciones en las que cuando se combinan directivas es interesante que se puedan comunicar entre ellas. Para ello se utiliza <code>require</code> que va a permitir inyectar el controlador de la directiva padre.</p>
<pre><code class="lang-html">&lt;accordion&gt;
    &lt;accordion-<span class="hljs-property">item</span> title=<span class="hljs-string">"A"</span>&gt;AAAAAAA&lt;/accordion-<span class="hljs-property">item</span>&gt;
    &lt;accordion-<span class="hljs-property">item</span> title=<span class="hljs-string">"B"</span>&gt;BBBBBBB&lt;/accordion-<span class="hljs-property">item</span>&gt;
    &lt;accordion-<span class="hljs-property">item</span> title=<span class="hljs-string">"C"</span>&gt;CCCCCCC&lt;/accordion-<span class="hljs-property">item</span>&gt;
&lt;/accordion&gt;

&lt;<span class="hljs-keyword">script</span> type=<span class="hljs-string">"text/ng-template"</span> <span class="hljs-property">id</span>=<span class="hljs-string">"accordion.html"</span>&gt;
    &lt;<span class="hljs-keyword">div</span> <span class="hljs-type">class</span>=<span class="hljs-string">"carousel"</span> ng-transclude&gt;&lt;/<span class="hljs-keyword">div</span>&gt;
&lt;/<span class="hljs-keyword">script</span>&gt;

&lt;<span class="hljs-keyword">script</span> type=<span class="hljs-string">"text/ng-template"</span> <span class="hljs-property">id</span>=<span class="hljs-string">"accordion-item.html"</span>&gt;
    &lt;<span class="hljs-keyword">div</span> <span class="hljs-type">class</span>=<span class="hljs-string">"carousel-item"</span>&gt;
        &lt;<span class="hljs-keyword">div</span> <span class="hljs-type">class</span>=<span class="hljs-string">"title"</span> ng-click=<span class="hljs-string">"select()"</span>&gt;{{title}}&lt;/<span class="hljs-keyword">div</span>&gt;
        &lt;<span class="hljs-keyword">div</span> ng-<span class="hljs-keyword">if</span>=<span class="hljs-string">"active"</span>&gt;
            &lt;<span class="hljs-keyword">div</span> ng-transclude&gt;&lt;/<span class="hljs-keyword">div</span>&gt;
        &lt;/<span class="hljs-keyword">div</span>&gt;
    &lt;/<span class="hljs-keyword">div</span>&gt;
&lt;/<span class="hljs-keyword">script</span>&gt;
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> app = angular.module(<span class="hljs-string">"app"</span>, []);

app.directive(<span class="hljs-string">"accordion"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
    <span class="hljs-keyword">return</span> {
        restrict: <span class="hljs-string">"E"</span>,
        templateUrl: <span class="hljs-string">"accordion.html"</span>,
        transclude: <span class="hljs-keyword">true</span>,
        controller: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$scope</span>)</span> {</span>
            <span class="hljs-keyword">var</span> <span class="hljs-keyword">self</span> = this;
            <span class="hljs-variable">$scope</span>.items = [];
            this.addItem = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(item)</span> {</span>
                <span class="hljs-variable">$scope</span>.items.push(item);
                <span class="hljs-keyword">self</span>.select(item);
            };
            this.select = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(selectedItem)</span> {</span>
                <span class="hljs-variable">$scope</span>.items.<span class="hljs-keyword">forEach</span>(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(item)</span> {</span>
                    item.active = selectedItem === item;
                });
            }
        },
        link: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(scope, element, attrs)</span> {</span>

        }
    };
});

app.directive(<span class="hljs-string">"accordionItem"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
    <span class="hljs-keyword">return</span> {
        restrict: <span class="hljs-string">"E"</span>,
        templateUrl: <span class="hljs-string">"accordion-item.html"</span>,
        transclude: <span class="hljs-keyword">true</span>,
        <span class="hljs-keyword">require</span>: <span class="hljs-string">'^accordion'</span>,
        scope : {
            title : <span class="hljs-string">"@"</span>
        },
        link: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(scope, element, attrs, carouselController)</span> {</span>
            carouselController.addItem(scope);
            scope.select = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
                carouselController.select(scope);
            }
        }
    }
});
</code></pre>
<p><a href="http://jsbin.com/hiwuv/3/edit">http://jsbin.com/hiwuv/3/edit</a></p>
<h2 id="router">Router</h2>
<p>El router de angular es un modulo separado <code>ngRoute</code>. Para instalarlo podemos utilizar bower. Para cargar el módulo en la aplicación es necesario declarar la dependencia </p>
<pre><code class="lang-js">angular.<span class="hljs-keyword">module</span>(<span class="hljs-string">'app'</span>, [<span class="hljs-string">'ngRoute'</span>]);
</code></pre>
<p>La vista que configura el router se renderiza con el tag <code>ng-view</code>.</p>
<pre><code class="lang-html"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">ng-view</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/ng-template"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"a.html"</span>&gt;</span><span class="javascript">
    A </span></span><span class="hljs-expression">{{<span class="hljs-variable">id</span>}}</span><span class="xml"><span class="javascript">
    &lt;a ng-href=<span class="hljs-string">"#b"</span>&gt;Go to B&lt;<span class="hljs-regexp">/a&gt;
</span></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span>

<span class="hljs-tag">&lt;<span class="hljs-title">script</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">"text/ng-template"</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"b.html"</span>&gt;</span><span class="javascript">
    B
    &lt;a ng-href=<span class="hljs-string">"#a/1"</span>&gt;Go to A&lt;<span class="hljs-regexp">/a&gt;
</span></span><span class="hljs-tag">&lt;/<span class="hljs-title">script</span>&gt;</span></span>
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> app = angular.module(<span class="hljs-string">"app"</span>, [<span class="hljs-string">"ngRoute"</span>]);

app.config(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$routeProvider</span>, <span class="hljs-variable">$locationProvider</span>)</span> {</span>
    <span class="hljs-variable">$routeProvider</span>.when(<span class="hljs-string">'/a/:id'</span>, {
        templateUrl: <span class="hljs-string">'a.html'</span>,
        controller: <span class="hljs-string">'AController'</span>
    }).when(<span class="hljs-string">'/b'</span>, {
        templateUrl: <span class="hljs-string">'b.html'</span>,
        controller: <span class="hljs-string">'BController'</span>
    }).otherwise({
        redirectTo: <span class="hljs-string">'/a/1'</span>
    });
});

app.controller(<span class="hljs-string">"AController"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$scope</span>, <span class="hljs-variable">$routeParams</span>)</span> {</span>
    <span class="hljs-variable">$scope</span>.id = <span class="hljs-variable">$routeParams</span>.id;
});

app.controller(<span class="hljs-string">"BController"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$scope</span>)</span> {</span>

});
</code></pre>
<p>Con <code>$routeParams</code> podemos acceder a las variables de la ruta.</p>
<h2 id="-watch-apply">$watch, $apply</h2>
<p>En el scope podemos encontrar los métodos <code>$watch</code> y <code>$apply</code>.</p>
<p>El método <code>$watch</code> sirve para observar cambios en atributos del scope.</p>
<pre><code class="lang-html"><span class="hljs-subst">&lt;</span>div ng<span class="hljs-attribute">-app</span><span class="hljs-subst">=</span><span class="hljs-string">"app"</span> ng<span class="hljs-attribute">-controller</span><span class="hljs-subst">=</span><span class="hljs-string">"MainController"</span><span class="hljs-subst">&gt;</span>
  <span class="hljs-subst">&lt;</span>input <span class="hljs-keyword">type</span><span class="hljs-subst">=</span><span class="hljs-string">"text"</span> ng<span class="hljs-attribute">-model</span><span class="hljs-subst">=</span><span class="hljs-string">"value"</span><span class="hljs-subst">&gt;</span>
<span class="hljs-subst">&lt;</span>/div<span class="hljs-subst">&gt;</span>
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> app = angular.module(<span class="hljs-string">"app"</span>, []);

app.controller(<span class="hljs-string">"MainController"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$scope</span>)</span> {</span>
  <span class="hljs-variable">$scope</span>.<span class="hljs-variable">$watch</span>(<span class="hljs-string">"value"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(newValue, oldValue)</span> {</span>
    console.log(<span class="hljs-string">"change"</span>, newValue, oldValue);
  });
});
</code></pre>
<p><a href="http://jsbin.com/volab/1/edit?html,js,output">http://jsbin.com/volab/1/edit?html,js,output</a></p>
<p>El método $apply es el que nos permite propagar los cambios que se produzcan fuera de elementos angular (controladores, servicios o eventos manejados por angular). Como he visto, angular trabaja directamente con objetos planos a diferencia de backbone, que trabaja con getter y setters. Es por eso que angular necesita algún mecanimos para detectar los cambios que se producen en los datos. Este mecanismo se llama dirty-checking y consiste en hacer comprobaciones de los campos para averiguar si han cambiado. Siempre que realicemos los cambios dentro de un contexto de angular, no tendremos que preocuparnos de activar el ciclo dirty-checking, se hará automáticamente. Si hacemos cambios en el modelo desde otros puntos de la aplicación, tendremos que llamar al metodo <code>scope.$apply()</code> para que se propaguen los cambios.</p>
<pre><code class="lang-html"><span class="xml"> <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">ng-app</span>=<span class="hljs-value">"app"</span> <span class="hljs-attribute">ng-controller</span>=<span class="hljs-value">"MainController"</span>&gt;</span>
    </span><span class="hljs-expression">{{<span class="hljs-variable">counter</span>}}</span><span class="xml">
 <span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span></span>
</code></pre>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> app = angular.module(<span class="hljs-string">"app"</span>, []);

app.controller(<span class="hljs-string">"MainController"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(<span class="hljs-variable">$scope</span>)</span> {</span>  
  <span class="hljs-variable">$scope</span>.counter = <span class="hljs-number">0</span>;
  setInterval(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
    <span class="hljs-variable">$scope</span>.counter++;
    <span class="hljs-variable">$scope</span>.<span class="hljs-variable">$apply</span>();
  }, <span class="hljs-number">1000</span>);  
});
</code></pre>
<p><a href="http://jsbin.com/nulux/1/edit?html,js,output">http://jsbin.com/nulux/1/edit?html,js,output</a></p>
<p>El método $apply es importante cuando estamos integrando código no escrito utilizando angular. Por ejemplo, cuando estamos creando una directiva para envolver un componente de jQuery.</p>
<h2 id="ejemplo">Ejemplo</h2>
<h2 id="recursos">Recursos</h2>
<ul>
<li><a href="http://shop.oreilly.com/product/0636920028055.do">http://shop.oreilly.com/product/0636920028055.do</a></li>
<li><a href="http://www.thinkster.io/angularjs/GtaQ0oMGIl/a-better-way-to-learn-angularjs">http://www.thinkster.io/angularjs/GtaQ0oMGIl/a-better-way-to-learn-angularjs</a></li>
<li><a href="http://www.thinkster.io/angularjs/GUIDJbpIie/angularjs-tutorial-learn-to-build-modern-web-apps">http://www.thinkster.io/angularjs/GUIDJbpIie/angularjs-tutorial-learn-to-build-modern-web-apps</a></li>
<li><a href="https://egghead.io/">https://egghead.io/</a></li>
</ul>

  </div>
  <footer><a href="http://twitter.com/axelhzf" about="_blank">Twitter</a><a href="http://github.com/axelhzf" about="_blank">Github</a></footer>
</body>